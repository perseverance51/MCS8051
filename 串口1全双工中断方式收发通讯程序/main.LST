C51 COMPILER V9.60.0.0   MAIN                                                              02/03/2022 13:13:39 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          
   2          /*------------------------------------------------------------------*/
   3          /* --- STC MCU International Limited -------------------------------*/
   4          /* --- STC 1T Series MCU RC Demo -----------------------------------*/
   5          /* --- Mobile: (86)13922805190 -------------------------------------*/
   6          /* --- Fax: 86-0513-55012956,55012947,55012969 ---------------------*/
   7          /* --- Tel: 86-0513-55012928,55012929,55012966 ---------------------*/
   8          /* --- Web: www.GXWMCU.com -----------------------------------------*/
   9          /* --- QQ:  800003751 ----------------------------------------------*/
  10          /* If you want to use the program or the program referenced in the  */
  11          /* article, please specify in which data and procedures from STC    */
  12          /*------------------------------------------------------------------*/
  13          
  14          
  15          /*************  ¹¦ÄÜËµÃ÷  **************
  16          
  17          ´®¿Ú1È«Ë«¹¤ÖÐ¶Ï·½Ê½ÊÕ·¢Í¨Ñ¶³ÌÐò¡£±¾Àý³ÌÊ¹ÓÃ22.1184MHZÊ±ÖÓ£¬ÈçÒª¸Ä±ä£¬ÇëÐÞ¸ÄÏÂÃæµÄ"¶¨ÒåÖ÷Ê±ÖÓ"µÄÖµ²¢ÖØÐÂ±àÒ
             -ë¡£
  18          
  19          ´®¿ÚÉèÖÃÎª£º115200,8,n,1.
  20          
  21          Í¨¹ýPCÏòMCU·¢ËÍÊý¾Ý, MCUÊÕµ½ºóÍ¨¹ý´®¿Ú°ÑÊÕµ½µÄÊý¾ÝÔ­Ñù·µ»Ø.
  22          
  23          ******************************************/
  24          
  25          /*************  ±¾µØ³£Á¿ÉùÃ÷  **************/
  26          #define MAIN_Fosc   11059200L //¶¨ÒåÖ÷Ê±ÖÓ22118400L
  27          #define RX1_Lenth   32      //´®¿Ú½ÓÊÕ»º³å³¤¶È
  28          #define BaudRate1   115200UL  //Ñ¡Ôñ²¨ÌØÂÊ
  29          
  30          
  31          #define Timer1_Reload (65536UL -(MAIN_Fosc / 4 / BaudRate1))    //Timer 1 ÖØ×°Öµ£¬ ¶ÔÓ¦300KHZ
  32          #define Timer2_Reload (65536UL -(MAIN_Fosc / 4 / BaudRate1))    //Timer 2 ÖØ×°Öµ£¬ ¶ÔÓ¦300KHZ
  33          
  34          #include  "STC15Fxxxx.H"
  35          
  36          
  37          /*************  ±¾µØ±äÁ¿ÉùÃ÷  **************/
  38          u8  idata RX1_Buffer[RX1_Lenth];  //½ÓÊÕ»º³å
  39          u8  TX1_Cnt;  //·¢ËÍ¼ÆÊý
  40          u8  RX1_Cnt;  //½ÓÊÕ¼ÆÊý
  41          bit B_TX1_Busy; //·¢ËÍÃ¦±êÖ¾
  42          //u8  idata Re_Data[] = "receive data:";
  43          
  44          /*************  ±¾µØº¯ÊýÉùÃ÷  **************/
  45          
  46          
  47          
  48          /**********************************************/
  49          void main(void)
  50          {
  51   1        B_TX1_Busy = 0;
  52   1        RX1_Cnt = 0;
  53   1        TX1_Cnt = 0;
  54   1      
C51 COMPILER V9.60.0.0   MAIN                                                              02/03/2022 13:13:39 PAGE 2   

  55   1        S1_8bit();        //8Î»Êý¾Ý
  56   1        S1_USE_P30P31();    //UART1 Ê¹ÓÃP30 P31¿Ú Ä¬ÈÏ
  57   1      //  S1_USE_P36P37();    //UART1 Ê¹ÓÃP36 P37¿Ú
  58   1      //  S1_USE_P16P17();    //UART1 Ê¹ÓÃP16 P17¿Ú
  59   1      
  60   1      /*
  61   1        TR1 = 0;      //²¨ÌØÂÊÊ¹ÓÃTimer1²úÉú
  62   1        AUXR &= ~0x01;    //S1 BRT Use Timer1;
  63   1        AUXR |=  (1<<6);  //Timer1 set as 1T mode
  64   1        TH1 = (u8)(Timer1_Reload >> 8);
  65   1        TL1 = (u8)Timer1_Reload;
  66   1        TR1  = 1;
  67   1      */
  68   1      
  69   1        AUXR &= ~(1<<4);  //Timer stop    ²¨ÌØÂÊÊ¹ÓÃTimer2²úÉú
  70   1        AUXR |= 0x01;   //S1 BRT Use Timer2;
  71   1        AUXR |=  (1<<2);  //Timer2 set as 1T mode
  72   1        TH2 = (u8)(Timer2_Reload >> 8);
  73   1        TL2 = (u8)Timer2_Reload;
  74   1        AUXR |=  (1<<4);  //Timer run enable
  75   1      
  76   1        REN = 1;  //ÔÊÐí½ÓÊÕ
  77   1        ES  = 1;  //ÔÊÐíÖÐ¶Ï
  78   1      
  79   1        EA = 1;   //ÔÊÐíÈ«¾ÖÖÐ¶Ï
  80   1        
  81   1      
  82   1        while (1)
  83   1        {
  84   2          if(TX1_Cnt != RX1_Cnt)    //ÊÕµ½¹ýÊý¾Ý
  85   2          {
  86   3            if(!B_TX1_Busy)   //·¢ËÍ¿ÕÏÐ
  87   3            {
  88   4              B_TX1_Busy = 1;   //±êÖ¾·¢ËÍÃ¦
  89   4              SBUF = RX1_Buffer[TX1_Cnt]; //·¢Ò»¸ö×Ö½Ú
  90   4              if(++TX1_Cnt >= RX1_Lenth)  TX1_Cnt = 0;  //±ÜÃâÒç³ö´¦Àí
  91   4            }
  92   3          }
  93   2        }
  94   1      }
  95          
  96          /********************* UART1ÖÐ¶Ïº¯Êý************************/
  97          void UART1_int (void) interrupt UART1_VECTOR
  98          {
  99   1        if(RI)
 100   1        {
 101   2          RI = 0;
 102   2          RX1_Buffer[RX1_Cnt] = SBUF;   //±£´æÒ»¸ö×Ö½Ú
 103   2          if(++RX1_Cnt >= RX1_Lenth)  RX1_Cnt = 0;  //±ÜÃâÒç³ö´¦Àí
 104   2        }
 105   1      
 106   1        if(TI)
 107   1        {
 108   2          TI = 0;
 109   2          B_TX1_Busy = 0;   //Çå³ý·¢ËÍÃ¦±êÖ¾
 110   2        }
 111   1      }
 112          
 113          
 114          


C51 COMPILER V9.60.0.0   MAIN                                                              02/03/2022 13:13:39 PAGE 3   

MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    130    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =     32    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
