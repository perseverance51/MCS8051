C51 COMPILER V9.60.0.0   PCF8591                                                           04/04/2022 18:38:58 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE PCF8591
OBJECT MODULE PLACED IN PCF8591.OBJ
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE PCF8591.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include "PCF8591.h"
   2          #include "delay.h"
   3          
   4          
   5          sbit SCL=P2^1;  //´®ÐÐÊ±ÖÓÊäÈë¶Ë  
   6          sbit SDA=P2^0;  //´®ÐÐÊý¾ÝÊäÈë¶Ë
   7          uchar flag=0;
   8          
   9          void start()//¿ªÊ¼ÐÅºÅ  
  10          {  
  11   1          SDA=1;  
  12   1          delay();  
  13   1          SCL=1;  
  14   1          delay();  
  15   1          SDA=0;  
  16   1          delay();  
  17   1      }  
  18            
  19          void stop() //Í£Ö¹ÐÅºÅ  
  20          {  
  21   1          SDA=0;  
  22   1          delay();  
  23   1          SCL=1;  
  24   1          delay();  
  25   1          SDA=1;  
  26   1          delay();  
  27   1      }  
  28            
  29            
  30          void respons()//Ó¦´ð    Ïàµ±ÓÚÒ»¸öÖÇÄÜµÄÑÓÊ±º¯Êý  
  31          {  
  32   1          uchar i;  
  33   1          SCL=1;  
  34   1          delay();  
  35   1          while((SDA==1)&&(i<250))  
  36   1              i++;  
  37   1          SCL=0;  
  38   1          delay();  
  39   1      }  
  40            
  41          void init() //³õÊ¼»¯  
  42          {  
  43   1          SDA=1;  
  44   1          delay();  
  45   1          SCL=1;  
  46   1          delay();      
  47   1      }  
  48            
  49          void write_byte(uchar date) //Ð´Ò»×Ö½ÚÊý¾Ý  
  50          {  
  51   1          uchar i,temp;  
  52   1          temp=date;  
  53   1          for(i=0;i<8;i++)  
  54   1          {  
  55   2              temp=temp<<1; //×óÒÆÒ»Î» ÒÆ³öµÄÒ»Î»ÔÚCYÖÐ  
C51 COMPILER V9.60.0.0   PCF8591                                                           04/04/2022 18:38:58 PAGE 2   

  56   2              SCL=0;          //Ö»ÓÐÔÚscl=0Ê±sdaÄÜ±ä»¯Öµ  
  57   2              delay();  
  58   2              SDA=CY;  
  59   2              delay();  
  60   2              SCL=1;  
  61   2              delay();          
  62   2          }     
  63   1          SCL=0;  
  64   1          delay();  
  65   1          SDA=1;  
  66   1          delay();  
  67   1      }  
  68            
  69            
  70            
  71          void write_add(uchar control,uchar date)  
  72          {  
  73   1          start();  
  74   1          write_byte(PCF8591);    //10010000  Ç°ËÄÎ»¹Ì¶¨ ½ÓÏÂÀ´ÈýÎ»È«²¿±»½ÓµØÁË ËùÒÔ¶¼ÊÇ0 ×îºóÒ»Î»ÊÇÐ´ ËùÒÔÎªµÍµ
             -çÆ½  
  75   1          respons();  
  76   1          write_byte(control);  
  77   1          respons();  
  78   1          write_byte(date);  
  79   1          respons();  
  80   1          stop();  
  81   1        
  82   1      }  
  83          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    153    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
